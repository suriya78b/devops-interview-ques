# üê≥ Kubernetes (AKS/EKS) & Container Security
## 1. Write manifest YAML for different kind like service, secrets, volums, pod, deployment, etc.,
## 2. How do you upgrade your k8s cluster?
In a production environment, upgrading a Kubernetes cluster requires careful planning to ensure minimal disruption, high availability, and compatibility.

### First, planning phase:

1. Review the official Kubernetes release notes, changelog, and deprecation notices for the target version to identify breaking changes, removed APIs, or new features.
2. Check for deprecated/removed APIs in your manifests using tools like pluto or kube-no-trouble.
3. Backup etcd (critical for state) and ensure you have recent snapshots.
4. Test the upgrade in a staging environment that mirrors production (same add-ons, workloads, etc.).
5. Verify compatibility of add-ons (e.g., CSI drivers, ingress controllers, monitoring) and third-party tools.

The actual upgrade process depends on whether it's a self-managed cluster (e.g., using kubeadm) or managed (e.g., EKS, GKE, AKS).
### For self-managed (kubeadm) clusters:

1. On the primary control plane node: Run kubeadm upgrade plan to check feasibility and available versions.
2. Upgrade kubeadm: apt update && apt install kubeadm=<target-version>.
3. Apply the upgrade: kubeadm upgrade apply <target-version>.
4. Upgrade kubelet and kubectl on the control plane: apt install kubelet=<target-version> kubectl=<target-version> and restart kubelet.
4. Drain and upgrade additional control plane nodes one by one.
#### For worker nodes: 
- Drain the node (kubectl drain), upgrade kubeadm/kubelet, then kubeadm upgrade node, restart kubelet, and uncordon.
- Post-upgrade: Verify with kubectl get nodes, check pod status, and monitor for issues.

### For managed clusters (common in enterprises):

- AWS EKS: Use the AWS console/CLI (aws eks update-cluster-version) to upgrade the control plane (AWS handles it with zero downtime). Then update managed node groups (via console or eksctl) or self-managed nodes. EKS supports up to 3 minor version skew in newer versions.
- Google GKE: Enable auto-upgrades or manually upgrade via console/gcloud. Options include surge (add nodes during upgrade) or blue-green. GKE handles node auto-repairs and upgrades seamlessly.
- Azure AKS: Use Azure CLI/portal to upgrade control plane, then node pools. Supports planned maintenance windows.

### Best practices I follow:

- Use Pod Disruption Budgets (PDBs) and proper affinities to maintain availability during node drains.
- Upgrade one minor version at a time to reduce risk.
- Monitor during/after with tools like Prometheus or cloud-native monitoring.
- Have a rollback plan (e.g., etcd restore for self-managed; managed services often auto-rollback failed control plane upgrades).
- Schedule during maintenance windows and communicate with stakeholders.

## 6. RBAC
## 7. Network policy
## 8. How do you secure inter-pod communication in AKS using network policies and service mesh (e.g., Istio)?
## 9. What steps would you take to ensure container images are free from known vulnerabilities before they reach production?
## 10. How do you scale AKS workloads based on message queue depth or financial transaction volume?
## 11. Explain how you‚Äôd implement runtime security for containers using tools like Falco or eBPF.
## 12. Explain your production-grade Kubernetes architecture.
## 13. How do you troubleshoot CrashLoopBackOff and ImagePullBackOff?
## 14. What happens when readiness/liveness probes fail?
## 15. How do you implement autoscaling (HPA/VPA/Cluster Autoscaler)?
## 16. How do you manage secrets securely in Kubernetes (Vault / Sealed Secrets)?
## 17. Pods are getting evicted when traffic increases. How do you identify and resolve the eviction reason?
## 18. New pods stay in ‚ÄúPending‚Äù but the cluster autoscaler is not creating new nodes. What could be wrong?
## 19. A pod is running but refuses TCP connections ‚Äì how do you debug?
## 20. How do you handle GPU scheduling in EKS (or GKE)?
## 21. How do you implement secure multi-tenant namespaces in Kubernetes?
## 22. What are the scale limits of kube-proxy iptables, and how do you fix them?
## 23. How do you detect and resolve half-open TCP connections from a service mesh?
## 24. What is the use of Helm in Kubernetes?
## 25. Explain how Kubernetes schedules a pod from request ‚Üí running state.
## 26. What are Deployments, StatefulSets, and DaemonSets?
## 27. What are readiness vs liveness probes and why are they important?
## 28. How do you implement secrets securely in Kubernetes?
## 29. How would you troubleshoot CrashLoopBackOff or ImagePullBackOff?
## 30. Pod in CrashLoopBackOff ‚Äî how do you debug?
## 31. Deployment vs StatefulSet vs DaemonSet ‚Äî real use cases?
## 32. How do you expose a service externally?
33. How do ConfigMaps and Secrets work?
34. RollingUpdate vs Recreate strategy ‚Äî when to use which?
